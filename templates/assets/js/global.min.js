(()=>{"use strict";function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){for(var n,a=0;a<t.length;a++){var i=t[a];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,(n=function(e){if("object"!==o(e)||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0===t)return String(e);t=t.call(e,"string");if("object"!==o(t))return t;throw new TypeError("@@toPrimitive must return a primitive value.")}(i.key),"symbol"===o(n)?n:String(n)),i)}}function t(e,t,n){t&&a(e.prototype,t),n&&a(e,n),Object.defineProperty(e,"prototype",{writable:!1})}function n(e,t){var n,a,t=1<arguments.length&&void 0!==t?t:0;null!=(n=window)&&n.drawEchartsDom&&(a=window.echarts.init(window.drawEchartsDom,e),1===t&&(a.dispose(),a=window.echarts.init(window.drawEchartsDom,e)),a.setOption(window.drawEchartsOption),window.addEventListener("resize",function(){return a.resize()}))}t(l,[{key:"on",value:function(e,t){this.events[e]||(this.events[e]||(this.events[e]=[]),this.events[e].push(t))}},{key:"emit",value:function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];this.events[e]&&this.events[e].forEach(function(e){return e.apply(void 0,n)})}},{key:"off",value:function(e,t){this.events[e]&&(this.events[e]=this.events[e].filter(function(e){return e!==t}))}},{key:"has",value:function(e){return!!this.events[e]}},{key:"get",value:function(e){return this.events[e]}}]);var i=l,r=(t(s,[{key:"theme",get:function(){return localStorage.getItem("butterfly-theme")}},{key:"matchOS",get:function(){return window.matchMedia("(prefers-color-scheme:dark)")}},{key:"followOS",value:function(){window.matchMedia("(prefers-color-scheme:dark)").matches?(window.eventCore.emit("changeTheme","dark"),n("dark",1),$("html").attr("data-theme","dark"),localStorage.setItem("Butterfly-data-theme","dark"),window.dataTheme="dark"):(window.eventCore.emit("changeTheme","light"),n("light",1),$("html").attr("data-theme","light"),localStorage.setItem("Butterfly-data-theme","light"),window.dataTheme="light")}},{key:"setThemeWithOS",value:function(){this.matchOS.addEventListener("change",this.followOS)}},{key:"init",value:function(){var e=this,t=$("html");$(".menu-item.toggle").on("click",function(){t.addClass("active-mask"),e.switchSidebar(1)}),window.lazyLoadInstance=new LazyLoad({elements_selector:"img",threshold:0,data_src:"lazy-src"}),$(".adsorption .switch-model").on("click",function(){var e=localStorage.getItem("Butterfly-data-theme")||"light";window.eventCore.emit("changeTheme","light"===e?"dark":"light"),"light"===e?(n("dark",1),$("html").attr("data-theme","dark"),localStorage.setItem("Butterfly-data-theme","dark"),window.dataTheme="dark"):(n("light",1),$("html").attr("data-theme","light"),localStorage.setItem("Butterfly-data-theme","light"),window.dataTheme="light")}),$(".adsorption .back-top").on("click",function(){$("html").animate({scrollTop:0},300)}),$(".global-mask").on("click",function(){t.removeClass("active-mask"),e.switchSidebar(0)})}},{key:"switchSidebar",value:function(e){var t=$(".sidebar");1===e?t.css({transform:"translate3d(-100%, 0, 0)"}):t.css({transform:"translate3d(0, 0, 0)"})}},{key:"sidebar",value:function(){var e=$(".sidebar-menus .menu-item");e.length&&e.each(function(){$(this).hasClass("relative")&&$(this).on("click",function(){$(this).toggleClass("active").children(".menu-child").stop().toggle("fast")})})}},{key:"scroll",value:function(){var n=$(".header .nav"),a=$(".adsorption"),i=$(".post .aside .post-sticky"),o=0;window.addEventListener("scroll",function(n,a){function i(){l=!1===a.leading?0:(new Date).getTime(),o=null,n.apply(r,s),r=s=null}var o,r,s,l=0;a=a||{};return function(){var e=(new Date).getTime(),t=200-(e-(l=l||!1!==a.leading?l:e));r=this,s=arguments,t<=0||200<t?(o&&(clearTimeout(o),o=null),l=e,n.apply(r,s),o||(r=s=null)):o||!1===a.leading||(o=setTimeout(i,t))}}(function(e){var t=window.scrollY||document.documentElement.scrollTop;56<t?(o<=t?(n.hasClass("visible")&&n.addClass("hidden").removeClass("visible"),i&&i.css("top",""),a.hasClass("active")||a.addClass("active")):(n.hasClass("visible")||n.addClass("visible").removeClass("hidden"),i&&i.css("top","70px")),n.hasClass("style")||n.addClass("style")):0===t&&(n.removeClass("style visible hidden"),a.hasClass("active"))&&a.removeClass("active"),o=t}))}},{key:"runDay",value:function(){var e,t,n=$(".aside-web-info .run-day");n&&(t=n.attr("data-runday"))&&("Invalid Date"!==(e=new Date).toString()?(e=e.getTime()-new Date(t).getTime(),t=parseInt((e/864e5).toString()),n.html(t+" 天")):n.html('<span style="color:#fd0000">建站时间配置错误</span>'))}}]),s);function s(){e(this,s),this.init(),this.setThemeWithOS(),this.sidebar(),this.scroll(),this.runDay(),window.eventCore=new i}function l(){e(this,l),this.events={}}document.addEventListener("DOMContentLoaded",function(){return window.GlobalClass=new r})})();